# 后端八股学习笔记

想要生活能进步，就不能走退步路。

## 计算机网络

网络是把主机连接起来，而互联网(Internet)是把多种不同的网络连接起来，因此互联网是网络的网络，而互联网(Internet)是全球范围的互联网。![img](https://cs-notes-1256109796.cos.ap-guangzhou.myqcloud.com/network-of-networks.gif)

## ISP

互联网服务提供商ISP可以从**互联网管理机构**获得许多IP地址，同时拥有通信线路以及路由器等联网设备，个人或机构向ISP缴纳一定的费用就可以接入互联网。

![img](https://cs-notes-1256109796.cos.ap-guangzhou.myqcloud.com/72be01cd-41ae-45f7-99b9-a8d284e44dd4.png)

目前的互联网是一种多层次ISP结构，ISP根据覆盖面积的大小分为**第一层ISP**，**区域ISP**和**接入ISP**。**互联网交换点IXP（Internet Exchange Point)**允许两个ISP直接相连而不用经过第三个ISP。

![img](https://cs-notes-1256109796.cos.ap-guangzhou.myqcloud.com/3be42601-9d33-4d29-8358-a9d16453af93.png)

## 主机之间的通信方式

- **客户-服务器（C/S）**：客户是服务的请求方，服务器![img](https://cs-notes-1256109796.cos.ap-guangzhou.myqcloud.com/914894c2-0bc4-46b5-bef9-0316a69ef521.jpg)是服务的提供方。



- **对等（P2P）**：不区分客户和服务器

![img](https://cs-notes-1256109796.cos.ap-guangzhou.myqcloud.com/42430e94-3137-48c0-bdb6-3cebaf9102e3.jpg)

## 电路交换与分组交换

### 1.电路交换

电路交换用于电话通信系统，两个用户要通信之前需要建立一条专用的物理链路，并且在整个通信过程中始终占用该链路。由于通信的过程中不可能一直在使用传输线路，因此电路交换对线路的利用率很低，往往不到10%。

### 2.分组交换

每个分组都有**首部**和**尾部**，包含了**源地址**和**目的地址**等控制信息，在同一个传输线路上同时传输多个分组互相不影响，因此在同一条传输线路上允许同时传输多个分组，也就是说分组交换不需要占用传输线路。

在同一个邮局通信系统中，邮局收到一份邮件之后，先存储下来，然后把相同目的地的邮件一起转发到下一个目的地，这个过程就是**存储转发**的过程，分组交换也使用了存储转发过程。

## 时延

总时延 = 排队时延 + 处理时延 + 传输时延 + 传播时延

![img](https://cs-notes-1256109796.cos.ap-guangzhou.myqcloud.com/4b2ae78c-e254-44df-9e37-578e2f2bef52.jpg)

### 1.排队时延

分组在路由器的输入队列和输出队列中排队等待的时间，取决于网络当前的通信量。

### 2.处理时延

主机或路由器收到分组时进行处理所需要的时间，例如分析首部、从分组中提取数据、进行差错检验或**查找适当的路由**等。

### 3.传输时延

主机或路由器传输数据帧所需要的时间。
$$
delay = \frac{l(bit)}{v(bit/s)}
$$
$l$:数据帧的长度, $v$:传输速率

### 4.传播时延

电磁波在信道中传播所需要花费的时间，电磁波传播的速度接近光速。
$$
delay = \frac{l(m)}{v(m/s)}
$$
$l$:表示信道长度， $v$:表示电磁波在信道上的传播速度

## 计算机网络体系结构

![img](https://cs-notes-1256109796.cos.ap-guangzhou.myqcloud.com/0fa6c237-a909-4e2a-a771-2c5485cd8ce0.png)

### 1.五层协议

- **应用层**：**为特定应用程序提供数据传输服务**，例如HTTP，DNS等协议。数据单位为**报文**。
- **传输层**：**为进程提供通用数据传输服务**。由于应用层协议很多，定义通用的传输层协议就可以支持不断增多的应用层协议。运输层包括两种协议：**传输控制协议TCP**，提供面向连接、可靠的数据传输服务，数据单位为**报文段**；**用户数据报协议UDP**，提供无连接的、尽最大努力的数据传输服务，数据单位为**用户数据报**。TCP主要提供**完整性服务**，UDP主要提供**及时性服务**。

- **网络层**：**为主机提供数据传输服务**。而传输层协议是为主机中的进程提供数据传输服务。网络层把传输层传递下来的报文段或者用户数据报封装成**分组**。

- **数据链路层**：网络层针对的还是主机之间的数据传输服务，而主机之间可以有很多链路，链路层协议就是**为同一链路的主机提供数据传输服务**。数据链路层把网络层传下来的分组封装成**帧**。

- **物理层**：考虑的是怎样在传输媒体上传输**比特流**，而不是指具体的传输媒体。物理层的作用是尽可能屏蔽传输媒体和通信手段的差异，使数据链路层感觉不到这些差异。

### 2.OSI

(Open Systems Interconnection，开放式系统互联)

其中表示层和会话层用途如下：

- **表示层**：数据压缩、加密以及数据描述，这使得应用程序不必关心在各台主机中数据内部格式不同的问题。
- **会话层**：建立及管理会话。

五层协议没有表示层和会话层，而是将这些功能留给应用程序开发者处理。

### 3.TCP/IP

![img](https://cs-notes-1256109796.cos.ap-guangzhou.myqcloud.com/48d79be8-085b-4862-8a9d-18402eb93b31.png)

只有四层，相当于五层协议中数据链路层和物理层合并为网络接口层。

TCP/IP体系结构不严格遵循OSI分层概念，应用层可能会直接使用IP层或者网络接口层。

### 4.数据在各层之间的传递过程

在向下的过程中，需要添加下层协议所需要的首部和尾部，而在向上的过程中不断拆开首部和尾部。

路由器只有下面三层协议，因为路由器位于网络核心中，不需要为进程或者应用程序提供服务，因此也就不需要传输层和应用层。

## 物理层

### 通信方式

根据信息在传输线上的传送方向，分为一下三种通信方式：

- 单工通信：单向传输
- 半双工通信：双向交替传输
- 全双工通信：双向同时传输

### 带通调制

模拟信号是连续的信号，数字信号是离散的信号。带通调制把数字信号转换为模拟信号。

![img](https://cs-notes-1256109796.cos.ap-guangzhou.myqcloud.com/c34f4503-f62c-4043-9dc6-3e03288657df.jpg)

## 链路层

### 基本问题

#### 1.封装成帧

把网络层传下来的分组添加首部和尾部，用于标记帧的开始和结束。

![img](https://cs-notes-1256109796.cos.ap-guangzhou.myqcloud.com/29a14735-e154-4f60-9a04-c9628e5d09f4.png)

#### 2.透明传输

透明表示一个实际存在的事物看起来好像不存在一样。

帧使用首部和尾部进行定界，如果帧的数据部分含有和首部尾部相同的内容，那么帧的开始和结束位置就会被错误的判定。需要在数据部分出现首部尾部相同的内容前面插入转义字符。如果数据部分出现转义字符，那么就在转义字符前面再加个转义字符。在接收端处理之后可以还原出原始数据。这个过程透明传输的内容是转义字符，用户察觉不到转义字符的存在。

![img](https://cs-notes-1256109796.cos.ap-guangzhou.myqcloud.com/e738a3d2-f42e-4755-ae13-ca23497e7a97.png)

#### 3.差错检测

目前数据链路层广泛使用了**循环冗余检验（CRC，Cyclic Redundancy Check）**来检查比特差错。

### 信道分类

#### 1.广播信号

一对多通信，一个节点发送的数据能够被广播信道上所有的节点接受到。

所有的节点都在同一个广播信道上发送数据，因此需要有专门的控制方法进行协调，避免发生冲突（冲突也叫碰撞）。

主要有两种控制方法进行协调，一个是使用信道复用技术；另一个是使用CSMA/CD协议。

#### 2.点对点信道

一对一通信。

因为不会发生碰撞，因此也比较简单，使用PPP（Point-to-Point Protocol）协议进行控制。

### 信道复用技术

#### 1.频分复用

频分复用的所有主机在相同的时间占用不同的频率带宽资源。

![img](https://cs-notes-1256109796.cos.ap-guangzhou.myqcloud.com/4aa5e057-bc57-4719-ab57-c6fbc861c505.png)

#### 2.时分复用

时分复用的所有主机在不同的事件占用相同的频率带宽资源。

![img](https://cs-notes-1256109796.cos.ap-guangzhou.myqcloud.com/67582ade-d44a-46a6-8757-3c1296cc1ef9.png)

使用频分复用和时分复用进行通信，在通信的过程中主机会一直占用一部分信道资源。但是由于计算机数据的突发性质，通信过程没必要一直占用信道资源而不让出给其他用户使用，因此这两种方式对信道的利用率都不高。

#### 3.统计时分复用

是对时分复用的一种改进，不固定每个用户在时分复用帧中的位置，只要有数据就集中起来组成统计时分复用帧然后发送。

![img](https://cs-notes-1256109796.cos.ap-guangzhou.myqcloud.com/6283be2a-814a-4a10-84bf-9592533fe6bc.png)

#### 4.波分复用

光的频分复用。由于光的频率很高，因此习惯上用波长而不是频率来表示所使用的光载波。

#### 5.码分复用

为每个用户分配$m\  bit$ 的码片，并且所有的码片正交，对于任意两个码片$\vec{S}$和$\vec{T}$有
$$
\frac{1}{m}\vec{S}\ \cdot  \vec{T} = 0
$$
为了讨论方便，取$m=8$, 设码片$\vec{S}$为$00011011$。在拥有该码片额用户发送比特1时就发送该码片，发送比特0时就发送该码片的反码$11100100$

在计算时将$00011011$记作（$-1-1-1+1+1-1+1+1$）,可以得到：
$$
\frac{1}{m}\vec{S} \cdot \vec{S}=1
$$

$$
\frac{1}{m}\vec{S} \cdot \vec{S}'=-1
$$

其中$\vec{S}'$是$\vec{S}$的反码

利用上面的式子可知，当接收端使用码片$\vec{S}'$对接受到的数据进行内积运算时， 结果为0的是其它用户发送的数据，结果为1的是用户发送的比特1,结果为-1的是用户发送的比特0。

码分复用需要发送的数据量为原先的m倍。

![img](https://cs-notes-1256109796.cos.ap-guangzhou.myqcloud.com/99b6060e-099d-4201-8e86-f8ab3768a7cf.png)

## CSMA/CD协议

CSMA/CD表示载波监听多点接入/碰撞检测。

- **多点接入**：说明这是总线型网络，许多主机以多点的方式连接到总线上
- **载波监听**：每个主机都必须不停地监听信道。在发送前，如果监听到信道正在使用，就必须等待。
- **碰撞检测**：在发送中，如果监听到信道已有其他主机正在发送数据，就表示发生了碰撞。虽然每个主机在发送数据之前都已经监听到信道为空闲，但是由于电磁波的传播时延的存在，还是有可能会发生碰撞。

记端到端的传播时延为$\tau$, 最先发送的站点最多经过$2\tau$就可以知道是否发生了碰撞，称$2\tau$为争用期。只有经过争用期之后还没有检测到碰撞，才能肯定这次发送不会发生碰撞。

当发生碰撞时， 站点要停止发送，等待一段时间再发送。这个时间采用**截断二进制指数退避算法**来确定。从离散的整数集合$\{0, 1, ..., (2^k-1)\}$中随机取出一个数，记作$r$， 然后取$r$倍的争用期作为**重传等待时间**。

![img](https://cs-notes-1256109796.cos.ap-guangzhou.myqcloud.com/19d423e9-74f7-4c2b-9b97-55890e0d5193.png)

## PPP协议

互联网用户通常需要连接到某个ISP之后才能接入互联网，PPP协议时用户计算机和ISP进行通信时所使用的数据链路层协议。

![img](https://cs-notes-1256109796.cos.ap-guangzhou.myqcloud.com/e1ab9f28-cb15-4178-84b2-98aad87f9bc8.jpg)

PPP的帧格式：

- F字段为帧的**定界符**
- A和C字段暂时没有意义
- FCS字段是使用CRC的**检验序列**
- 信息部分的长度不超过1500

![img](https://cs-notes-1256109796.cos.ap-guangzhou.myqcloud.com/759013d7-61d8-4509-897a-d75af598a236.png)

## MAC地址

MAC地址是链路层地址，长度为6字节（48位）， 用于唯一表示网络适配器（网卡）。

一台主机拥有多少个网络适配器就有多少个MAC地址。例如笔记本电脑普遍存在无限网络适配器和有线网络适配器，因此就有两个MAC地址。

## 局域网

局域网是一种典型的广播信道，主要特点是网络为一个单位所拥有， 且地理范围和站点数目均有限。

主要有以太网、令牌环网络、FDDI和ATM等局域网技术，目前以太网占领着有线局域网市场。

可以按照**网络拓扑结构**对局域网进行分类。

![img](https://cs-notes-1256109796.cos.ap-guangzhou.myqcloud.com/807f4258-dba8-4c54-9c3c-a707c7ccffa2.jpg)

## 以太网

以太网是一种星型拓扑结构局域网。

早起使用集线器进行连接，集线器是一种物理层设备。作用于比特而不是帧，当一个比特到达接口时，集线器重新生成这个比特，并将其能量强度放大，从而扩大网络的传输距离，之后再将这个比特发送到其他所有接口。如果集线器同时收到两个不同接口的帧，那么就发生了碰撞。

目前以太网使用交换机替代了集线器，交换机是一种链路层设备，它不会发生碰撞，能根据MAC地址进行存储转发。

以太网格式：

- **类型**：标记上层使用的协议
- **数据**：长度为46~1500之间，如果太小则需要填充
- **FCS**：真检验序列，使用的时CRC检验方法

![img](https://cs-notes-1256109796.cos.ap-guangzhou.myqcloud.com/164944d3-bbd2-4bb2-924b-e62199c51b90.png)

## 交换机
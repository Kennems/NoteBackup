# 第六天作业

![image-20240711164818076](https://cdn.jsdelivr.net/gh/kennems/blog-image/image-20240711164818076.png)

<img src="https://cdn.jsdelivr.net/gh/kennems/blog-image/image-20240711164942903.png" alt="image-20240711164942903" style="zoom: 80%;" />

## 项目概述

运用组件实现滑动列表，支持点击查看详情大图和文案，包含下拉刷新功能

## 功能拆解

## 一、页面布局

#### 1、有两个页面，一个首页，一个详情页面

#### 2、首页有一个列表，列表中有两种类型：一个文字类型，一个图片类型

#### 3、点击列表条目可以跳转到详情页

#### 4、详情页展示对应的类型，如果点击文字类型则显示文字详情，如果点击图片类型则展示该图片详情

**准备工作**：

**首页和详情页的创建**：

- `MainActivity` 作为应用的主活动，包含两个页面：`HomeFragment` 和 `ProfileFragment`。
- 使用 `BottomNavigationView` 实现页面切换，默认选择 `HomeFragment`。

**首页列表展示**：

- 在 `HomeFragment` 中使用 `RecyclerView` 展示一个包含两种类型（文字和图片）的列表。
- `MultiItemAdapter` 适配器根据不同的类型加载不同的布局（文字布局和图片布局）。

**点击列表条目跳转详情页**：

- 在 `MultiItemAdapter` 中为每个列表项设置点击事件。
- 如果点击的是文字类型，则跳转到 `TextDetailActivity` 并传递文字内容。
- 如果点击的是图片类型，则跳转到 `ImageDetailActivity` 并传递图片URL。

**详情页展示对应类型**：

- `TextDetailActivity` 根据传入的文字内容显示详细信息。
- `ImageDetailActivity` 根据传入的图片URL显示详细图片。

**实现以上功能的页面如下**：

**首页**：

![image-20240711222617773](https://cdn.jsdelivr.net/gh/kennems/blog-image/image-20240711222617773.png)

**图片详情页**：

![image-20240711222739382](https://cdn.jsdelivr.net/gh/kennems/blog-image/image-20240711222739382.png)



**文字详情页**：

![image-20240711222811799](https://cdn.jsdelivr.net/gh/kennems/blog-image/image-20240711222811799.png)



## 二、刷新、加载、点赞

### 5、首页需要支持下拉操作能够刷新首页，上拉操作能够加载更多，上拉3次后无法加载更多内容

### 6、首页图文和详情页图文都支持点赞，并且保持点赞状态的同步

准备工作：

- **下拉刷新功能**：
  - 使用 `SwipeRefreshLayout` 实现下拉刷新功能。
  - 在 `HomeFragment` 中设置 `SwipeRefreshLayout` 的刷新监听器，调用 `refreshData()` 方法刷新数据。
  - `refreshData()` 方法模拟刷新操作，从数据源重新加载数据，并更新 `RecyclerView` 的数据适配器。
- **上拉加载更多功能**：
  - 使用 `BaseLoadMoreModule` 实现上拉加载更多功能。
  - 在 `HomeFragment` 的 `onViewCreated()` 方法中，配置 `BaseLoadMoreModule` 并设置加载更多监听器。
  - 当用户上拉时，调用加载更多的方法，模拟加载更多数据并更新适配器。
  - 通过计数器控制加载更多操作的次数，在上拉加载3次后，调用 `loadMoreEnd()` 方法停止加载更多。

- **首页图文点赞**：
  - 在 `MultiItemAdapter` 中为每个图文项设置点赞按钮（心形图标）。
  - 为点赞按钮设置点击事件，切换点赞状态（心形图标填充与否）并更新适配器。
- **详情页图文点赞**：
  - 在 `TextDetailActivity` 和 `ImageDetailActivity` 中设置点赞按钮，并显示首页传递的点赞状态。
  - 为详情页中的点赞按钮设置点击事件，切换点赞状态并使用 `EventBus` 通知首页同步状态。
- **点赞状态同步**：
  - 使用 `EventBus` 进行跨页面通信。在 `MultiItemAdapter` 中注册 `EventBus` 监听器。
  - 当详情页的点赞状态改变时，发送 `HeartIconEvent` 事件，传递改变的点赞状态和位置。
  - 在 `MultiItemAdapter` 中接收 `HeartIconEvent` 事件，并更新对应位置的点赞状态，调用 `notifyItemChanged(position)` 刷新列表项。

**截图**：



![image-20240711223601220](https://cdn.jsdelivr.net/gh/kennems/blog-image/image-20240711223601220.png)

![image-20240711223612514](https://cdn.jsdelivr.net/gh/kennems/blog-image/image-20240711223612514.png)

**演示视频**：

[./录制MP4视频/videoShow.mp4](./录制MP4视频/videoShow.mp4)

<video src="./录制MP4视频/videoShow.mp4" controls style="width: 100%; height: auto;"></video>

